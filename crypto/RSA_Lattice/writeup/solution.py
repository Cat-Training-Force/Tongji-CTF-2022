from Crypto.Util.number import *

N = 17945028939774931382842970893091536312691897950694946279531695843980021601638040322631176085272781429408479495532856114843968845036846807774130795458590749232139680657884831293358950519467385931265100265075276412458542347626563715396059753203996756086910168614725375343433246902308060286996898134815893267337129206764670737103554439712182284367069331952387042324373424487923149833393537197459657574146049481597694811116914612906380401538215843888262745721892891309216004039834925799643990313806363455858119475678476847725802462689973257948855389523392173
e = 4271491640369051553863542071393474015645801990842839148218467133676202055339496843743830868308455303976889159541752247227567542978592447071231440730709307320343321824519714177375675260742469238474942815871599275245455890025189990579602063995988225560792072459690263106675253951
c = 2982045151756121388711523104037870685688633866332579059900739199660678731798398544530949093369004702046162368329869237913489419896944770987631661629834037053928972478727353212820908657194127381116621155342504231882391210623476722907667701726755165825520568875901287648959760942731883066670348370879711389267773248970048529052297910553027855956058594641736568312641876035925463276546105806270797595164439471682194969633061920115829517364232840483459907200021460098086199090505972757529528167385582874815611404253036300503327618311726519517779641651122935

''' sage
M = Matrix(ZZ, [[   e^2, 1, 0, 0],
                [     e, 0, 1, 0],
                [-(N-1), 0, 0, 1]])

weights = [2^60, 1, 1, 1]

MM = M * diagonal_matrix(weights)

v = MM.LLL()[0]
print('a =', v[0] / weights[0])
print('b =', v[3])
'''
a = 1878939723755137405
b = 882453896388926261626902042592903809

''' z3-solver
from z3 import *

sol = Solver()
k, l = Ints('k l')
a = 
b = 
sol.add(k + l - 1 == a)
sol.add(k * l == b)
sol.check()
print(sol.model())
'''
l = 951706078095491423
k = 927233645659645983

dp = inverse(e, k) + k
p = (e * dp - 1) // k + 1
q = N // p
d = inverse(e, (p-1)*(q-1))
m = pow(c, d, N)
print(long_to_bytes(m))
# He1l0_B13ich3nb4cher-M4y_A77ack
